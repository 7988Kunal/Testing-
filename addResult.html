<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - Student Result</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background: #eef2f3;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
    }
    .box {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
    }
    button:hover {
      background: #0056b3;
    }
    .danger { background: #dc3545; }
    .danger:hover { background: #b02a37; }
    .message { text-align: center; font-weight: bold; margin-top: 10px; }
    .success { color: green; }
    .error { color: red; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Manage Student Result</h2>
    <form id="resultForm">
      <input type="text" id="name" placeholder="Student Name" required />
      <input type="text" id="roll" placeholder="Roll Number" required />
      <input type="text" id="reg" placeholder="Registration Number" required />
      <input type="number" id="maths" placeholder="Maths Marks" />
      <input type="number" id="physics" placeholder="Physics Marks" />
      <input type="number" id="ai" placeholder="AI Marks" />
      <input type="text" id="status" placeholder="Status (Pass/Fail)" required />
      <input type="date" id="date" required />
      <button type="submit">Save Result</button>
      <button type="button" onclick="loadResult()">Load Result</button>
      <button type="button" class="danger" onclick="deleteResult()">Delete Result</button>
      <p id="success" class="message success"></p>
      <p id="error" class="message error"></p>
    </form>
  </div>  <!-- Firebase SDKs -->  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCzBDIhQ6N3t1ez-hya9wbeuYke5ci2Msg",
      authDomain: "uiet-results.firebaseapp.com",
      projectId: "uiet-results",
      storageBucket: "uiet-results.firebasestorage.app",
      messagingSenderId: "589523952286",
      appId: "1:589523952286:web:3704f7ba2e227c4560918f",
      measurementId: "G-NF26HW9W2T"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.getElementById("resultForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      clearMessages();
      const docId = getDocId();
      if (!docId) return showError("Roll + Reg required!");
      try {
        await db.collection("students").doc(docId).set({
          name: val("name"), roll: val("roll"), reg: val("reg"),
          marks: {
            Maths: val("maths"),
            Physics: val("physics"),
            AI: val("ai")
          },
          status: val("status"),
          date: val("date")
        });
        showSuccess("‚úÖ Result saved!");
        document.getElementById("resultForm").reset();
      } catch (err) {
        showError("‚ùå Error saving result.");
        console.error(err);
      }
    });

    async function loadResult() {
      clearMessages();
      const docId = getDocId();
      if (!docId) return showError("Roll + Reg required!");
      try {
        const doc = await db.collection("students").doc(docId).get();
        if (!doc.exists) return showError("‚ùå No result found.");
        const d = doc.data();
        setVal("name", d.name);
        setVal("maths", d.marks.Maths);
        setVal("physics", d.marks.Physics);
        setVal("ai", d.marks.AI);
        setVal("status", d.status);
        setVal("date", d.date);
        showSuccess("‚úÖ Result loaded!");
      } catch (err) {
        showError("‚ùå Load failed.");
        console.error(err);
      }
    }

    async function deleteResult() {
      clearMessages();
      const docId = getDocId();
      if (!docId) return showError("Roll + Reg required!");
      if (!confirm("Are you sure you want to delete this result?")) return;
      try {
        await db.collection("students").doc(docId).delete();
        showSuccess("üóë Result deleted.");
        document.getElementById("resultForm").reset();
      } catch (err) {
        showError("‚ùå Delete failed.");
        console.error(err);
      }
    }

    function val(id) { return document.getElementById(id).value.trim(); }
    function setVal(id, v) { document.getElementById(id).value = v || ''; }
    function getDocId() {
      const roll = val("roll");
      const reg = val("reg");
      return roll && reg ? `${roll}_${reg}` : null;
    }
    function showSuccess(msg) {
      document.getElementById("success").innerText = msg;
      document.getElementById("error").innerText = "";
    }
    function showError(msg) {
      document.getElementById("error").innerText = msg;
      document.getElementById("success").innerText = "";
    }
    function clearMessages() {
      showError("");
      showSuccess("");
    }
  </script></body>
</html>
