<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Page</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #e0f7fa;
      padding: 20px;
    }
    .panel {
      max-width: 500px;
      margin: 30px auto;
      background: #ffffff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
    }
    input, select, button {
      display: block;
      width: 100%;
      padding: 10px;
      margin: 10px 0;
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="panel" id="adminPanel">
    <h2>Admin Panel (40062kv)</h2>
    <input type="text" id="adminIndex" placeholder="Your Index Number">
    <div id="adminControls" class="hidden">
      <input type="text" id="newIndex" placeholder="Enter New Index">
      <input type="text" id="specialCode" placeholder="Assign Special Code">
      <button onclick="addIndex()">Add Index</button>
      <h3>Remove Index</h3>
      <select id="removeIndexDropdown"></select>
      <button onclick="removeIndex()">Remove Selected</button>
    </div>
  </div>  <div class="panel">
    <h2>Student Login</h2>
    <input type="text" id="loginIndex" placeholder="Enter Index Number">
    <input type="text" id="loginCode" placeholder="Enter Special Code">
    <button onclick="loginStudent()">Login</button>
  </div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD4Lk0EjPJAYPPKdzTBb-IOMP7kpzEmrFA",
      authDomain: "studentdashboard-final.firebaseapp.com",
      projectId: "studentdashboard-final",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.getElementById('adminIndex').addEventListener('input', async () => {
      const inputVal = document.getElementById('adminIndex').value.trim();
      if (inputVal === '40062kv') {
        document.getElementById('adminControls').classList.remove('hidden');
        loadIndexDropdown();
      } else {
        document.getElementById('adminControls').classList.add('hidden');
      }
    });

    async function addIndex() {
      const newIndex = document.getElementById('newIndex').value.trim();
      const code = document.getElementById('specialCode').value.trim();
      if (!newIndex || !code) return alert('Please fill both fields');
      await db.collection("indexCodes").doc(newIndex).set({ code });
      alert("Index added");
      document.getElementById('newIndex').value = '';
      document.getElementById('specialCode').value = '';
      loadIndexDropdown();
    }

    async function removeIndex() {
      const selectedIndex = document.getElementById('removeIndexDropdown').value;
      if (!selectedIndex) return alert('Select an index to remove');
      await db.collection("indexCodes").doc(selectedIndex).delete();
      alert("Index removed");
      loadIndexDropdown();
    }

    async function loadIndexDropdown() {
      const dropdown = document.getElementById('removeIndexDropdown');
      dropdown.innerHTML = '';
      const snapshot = await db.collection("indexCodes").get();
      snapshot.forEach(doc => {
        const option = document.createElement('option');
        option.value = doc.id;
        option.textContent = doc.id;
        dropdown.appendChild(option);
      });
    }

    async function loginStudent() {
      const index = document.getElementById('loginIndex').value.trim();
      const code = document.getElementById('loginCode').value.trim();
      const doc = await db.collection("indexCodes").doc(index).get();
      if (!doc.exists || doc.data().code !== code) {
        return alert("Invalid credentials");
      }
      localStorage.setItem("studentIndex", index);
      window.location.href = "register.html";
    }
  </script></body>
</html>