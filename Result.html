<!DOCTYPE html>
<html>
<head>
  <title>Student Result</title>
  <style>
    body {
      font-family: Arial;
      background: #f8f9fa;
      padding: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 600px;
      background: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 12px;
    }
    th {
      background-color: #f0f0f0;
      text-align: left;
    }
    h2 {
      color: #333;
    }
  </style>
</head>
<body>
  <h2>Student Result</h2>
  <div id="result-box">Loading...</div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCzBDIhQ6N3t1ez-hya9wbeuYke5ci2Msg",
      authDomain: "uiet-results.firebaseapp.com",
      projectId: "uiet-results",
      storageBucket: "uiet-results.firebasestorage.app",
      messagingSenderId: "589523952286",
      appId: "1:589523952286:web:3704f7ba2e227c4560918f",
      measurementId: "G-NF26HW9W2T"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const params = new URLSearchParams(window.location.search);
    const roll = params.get("roll");
    const reg = params.get("reg");
    const docId = `${roll}_${reg}`;

    async function loadResult() {
      try {
        const doc = await db.collection("students").doc(docId).get();
        if (!doc.exists) {
          document.getElementById("result-box").innerHTML = "<p>‚ùå No result found for this student.</p>";
          return;
        }

        const data = doc.data();
        let html = `<table>
          <tr><th>Name</th><td>${data.name}</td></tr>
          <tr><th>Roll Number</th><td>${data.roll}</td></tr>
          <tr><th>Registration Number</th><td>${data.reg}</td></tr>`;

        for (const subject in data.marks) {
          html += `<tr><th>${subject}</th><td>${data.marks[subject]}</td></tr>`;
        }

        html += `<tr><th>Status</th><td>${data.status}</td></tr>
                 <tr><th>Declared On</th><td>${data.date}</td></tr>
                 </table>`;

        document.getElementById("result-box").innerHTML = html;
      } catch (err) {
        document.getElementById("result-box").innerHTML = "<p>Error loading result.</p>";
        console.error(err);
      }
    }

    loadResult();
  </script>
</body>
</html>