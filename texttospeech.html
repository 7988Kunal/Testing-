<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Text Reader with Translation & Highlight</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    font-family: Arial, sans-serif;
    background:#f5f7ff;
    padding:20px;
}

.container{
    max-width:800px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,.1);
}

.controls{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    margin-bottom:15px;
}

select,button{
    padding:10px 14px;
    font-size:15px;
    border-radius:8px;
    border:1px solid #ccc;
    cursor:pointer;
}

button{
    background:#4f46e5;
    color:#fff;
    border:none;
}

button:hover{background:#4338ca}

#textBox{
    font-size:18px;
    line-height:1.6;
}

.highlight{
    background:yellow;
}
</style>
</head>

<body>

<div class="container">

<h2>üîä Smart Text Reader (English ‚Üî Hindi)</h2>

<div class="controls">
    <select id="langSelect">
        <option value="en">English</option>
        <option value="hi">Hindi</option>
    </select>

    <select id="voiceSelect"></select>

    <button onclick="translateText()">üåê Translate</button>
    <button onclick="speak()">‚ñ∂ Listen</button>
    <button onclick="stopSpeak()">‚èπ Stop</button>
</div>

<div id="textBox">
    EduPilot is India‚Äôs smart guidance platform helping students choose
    the right exams, careers, and learning paths with confidence.
</div>

</div>

<script>
let voices = [];
let utterance;
let originalText = document.getElementById("textBox").innerText;

// Load voices
function loadVoices(){
    voices = speechSynthesis.getVoices();
    const voiceSelect = document.getElementById("voiceSelect");
    voiceSelect.innerHTML = "";

    voices.forEach((v,i)=>{
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = `${v.name} (${v.lang})`;
        voiceSelect.appendChild(opt);
    });
}
speechSynthesis.onvoiceschanged = loadVoices;

// Speak with highlight
function speak(){
    stopSpeak();

    const textBox = document.getElementById("textBox");
    const text = textBox.innerText;
    const lang = document.getElementById("langSelect").value;

    utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = lang === "hi" ? "hi-IN" : "en-IN";

    const selectedVoice = voices[
        document.getElementById("voiceSelect").value
    ];
    if(selectedVoice) utterance.voice = selectedVoice;

    utterance.onboundary = function(event){
        if(event.name === "word"){
            highlightWord(event.charIndex, event.charLength);
        }
    };

    speechSynthesis.speak(utterance);
}

// Stop speaking
function stopSpeak(){
    speechSynthesis.cancel();
    removeHighlight();
}

// Highlight logic
function highlightWord(start, length){
    const box = document.getElementById("textBox");
    const text = box.innerText;

    box.innerHTML =
        text.substring(0,start) +
        `<span class="highlight">` +
        text.substring(start,start+length) +
        `</span>` +
        text.substring(start+length);
}

function removeHighlight(){
    document.getElementById("textBox").innerText =
        document.getElementById("textBox").innerText;
}

// Translation (using MyMemory free API)
function translateText(){
    const lang = document.getElementById("langSelect").value;
    const textBox = document.getElementById("textBox");

    if(lang === "en"){
        textBox.innerText = originalText;
        return;
    }

    fetch(
        `https://api.mymemory.translated.net/get?q=${encodeURIComponent(originalText)}&langpair=en|hi`
    )
    .then(res=>res.json())
    .then(data=>{
        textBox.innerText = data.responseData.translatedText;
    })
    .catch(()=>{
        alert("Translation failed");
    });
}
</script>

</body>
</html>
